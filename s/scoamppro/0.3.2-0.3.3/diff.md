# Comparing `tmp/scoamppro-0.3.2-py3-none-any.whl.zip` & `tmp/scoamppro-0.3.3-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,25 +1,25 @@
-Zip file size: 28385 bytes, number of entries: 23
--rw-r--r--  2.0 unx       22 b- defN 23-Jun-27 08:32 scoamp/__init__.py
--rw-r--r--  2.0 unx     6668 b- defN 23-Jun-27 08:32 scoamp/api.py
--rw-r--r--  2.0 unx     9566 b- defN 23-Jun-27 08:32 scoamp/toolkit.py
--rw-r--r--  2.0 unx      486 b- defN 23-Jun-27 08:32 scoamp/commands/__init__.py
--rw-r--r--  2.0 unx     4668 b- defN 23-Jun-27 08:32 scoamp/commands/api.py
--rw-r--r--  2.0 unx     7581 b- defN 23-Jun-27 08:32 scoamp/commands/lfs.py
--rw-r--r--  2.0 unx      117 b- defN 23-Jun-27 08:32 scoamp/commands/internal/__init__.py
--rw-r--r--  2.0 unx     1374 b- defN 23-Jun-27 08:32 scoamp/commands/internal/env.py
--rw-r--r--  2.0 unx    11723 b- defN 23-Jun-27 08:32 scoamp/commands/internal/public_model.py
--rw-rw-rw-  2.0 unx     2135 b- defN 23-Jun-27 08:32 scoamp/schema/public-model-meta.json
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-27 08:32 scoamp/utils/__init__.py
--rw-r--r--  2.0 unx     5080 b- defN 23-Jun-27 08:32 scoamp/utils/api_utils.py
--rw-r--r--  2.0 unx     1692 b- defN 23-Jun-27 08:32 scoamp/utils/error.py
--rw-r--r--  2.0 unx     5150 b- defN 23-Jun-27 08:32 scoamp/utils/helper.py
--rw-r--r--  2.0 unx      405 b- defN 23-Jun-27 08:32 scoamp/utils/logger.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-27 08:32 tests/__init__.py
--rw-r--r--  2.0 unx     9110 b- defN 23-Jun-27 08:32 tests/test_utils_helper.py
--rw-rw-rw-  2.0 unx    11334 b- defN 23-Jun-27 08:32 scoamppro-0.3.2.dist-info/LICENSE
--rw-r--r--  2.0 unx     1237 b- defN 23-Jun-27 08:32 scoamppro-0.3.2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-27 08:32 scoamppro-0.3.2.dist-info/WHEEL
--rw-r--r--  2.0 unx       48 b- defN 23-Jun-27 08:32 scoamppro-0.3.2.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       13 b- defN 23-Jun-27 08:32 scoamppro-0.3.2.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1872 b- defN 23-Jun-27 08:32 scoamppro-0.3.2.dist-info/RECORD
-23 files, 80373 bytes uncompressed, 25355 bytes compressed:  68.5%
+Zip file size: 28620 bytes, number of entries: 23
+-rw-r--r--  2.0 unx       22 b- defN 23-Jun-28 06:35 scoamp/__init__.py
+-rw-r--r--  2.0 unx     6668 b- defN 23-Jun-28 06:35 scoamp/api.py
+-rw-r--r--  2.0 unx    10676 b- defN 23-Jun-28 06:35 scoamp/toolkit.py
+-rw-r--r--  2.0 unx      486 b- defN 23-Jun-28 06:35 scoamp/commands/__init__.py
+-rw-r--r--  2.0 unx     4668 b- defN 23-Jun-28 06:35 scoamp/commands/api.py
+-rw-r--r--  2.0 unx     7581 b- defN 23-Jun-28 06:35 scoamp/commands/lfs.py
+-rw-r--r--  2.0 unx      117 b- defN 23-Jun-28 06:35 scoamp/commands/internal/__init__.py
+-rw-r--r--  2.0 unx     1374 b- defN 23-Jun-28 06:35 scoamp/commands/internal/env.py
+-rw-r--r--  2.0 unx    11723 b- defN 23-Jun-28 06:35 scoamp/commands/internal/public_model.py
+-rw-rw-rw-  2.0 unx     2135 b- defN 23-Jun-28 06:35 scoamp/schema/public-model-meta.json
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-28 06:35 scoamp/utils/__init__.py
+-rw-r--r--  2.0 unx     5080 b- defN 23-Jun-28 06:35 scoamp/utils/api_utils.py
+-rw-r--r--  2.0 unx     1692 b- defN 23-Jun-28 06:35 scoamp/utils/error.py
+-rw-r--r--  2.0 unx     5150 b- defN 23-Jun-28 06:35 scoamp/utils/helper.py
+-rw-r--r--  2.0 unx      405 b- defN 23-Jun-28 06:35 scoamp/utils/logger.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-28 06:35 tests/__init__.py
+-rw-r--r--  2.0 unx     9110 b- defN 23-Jun-28 06:35 tests/test_utils_helper.py
+-rw-rw-rw-  2.0 unx    11334 b- defN 23-Jun-28 06:35 scoamppro-0.3.3.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1237 b- defN 23-Jun-28 06:35 scoamppro-0.3.3.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-28 06:35 scoamppro-0.3.3.dist-info/WHEEL
+-rw-r--r--  2.0 unx       48 b- defN 23-Jun-28 06:35 scoamppro-0.3.3.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       13 b- defN 23-Jun-28 06:35 scoamppro-0.3.3.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     1873 b- defN 23-Jun-28 06:35 scoamppro-0.3.3.dist-info/RECORD
+23 files, 81484 bytes uncompressed, 25590 bytes compressed:  68.6%
```

## zipnote {}

```diff
@@ -45,26 +45,26 @@
 
 Filename: tests/__init__.py
 Comment: 
 
 Filename: tests/test_utils_helper.py
 Comment: 
 
-Filename: scoamppro-0.3.2.dist-info/LICENSE
+Filename: scoamppro-0.3.3.dist-info/LICENSE
 Comment: 
 
-Filename: scoamppro-0.3.2.dist-info/METADATA
+Filename: scoamppro-0.3.3.dist-info/METADATA
 Comment: 
 
-Filename: scoamppro-0.3.2.dist-info/WHEEL
+Filename: scoamppro-0.3.3.dist-info/WHEEL
 Comment: 
 
-Filename: scoamppro-0.3.2.dist-info/entry_points.txt
+Filename: scoamppro-0.3.3.dist-info/entry_points.txt
 Comment: 
 
-Filename: scoamppro-0.3.2.dist-info/top_level.txt
+Filename: scoamppro-0.3.3.dist-info/top_level.txt
 Comment: 
 
-Filename: scoamppro-0.3.2.dist-info/RECORD
+Filename: scoamppro-0.3.3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## scoamp/__init__.py

```diff
@@ -1 +1 @@
-__version__ = '0.3.2'
+__version__ = '0.3.3'
```

## scoamp/toolkit.py

```diff
@@ -44,14 +44,15 @@
     file_path: str,
     *,
     is_public: bool = False,
     revision: Optional[str] = None,
     local_dir: Optional[str] = None,
     force_download: bool = False,
     resume_download: bool = True,
+    remote_validate: bool = True,
 ) -> str:
     """Download a given file from amp server
     Args:
         model_id (`str`):
             model id.
         file_path (`str`):
             file path in the repo, with subfolder.
@@ -63,14 +64,16 @@
         local_dir (`str` or `Path`, *optional*):
             If provided, the downloaded file will be placed under this directory
         force_download (`bool`, *optional*, defaults to `False`):
             Whether the file should be downloaded even if it already exists in
             the local dir.
         resume_download (`bool`, *optional*, defaults to `False`):
             If `True`, resume a previously interrupted download.
+        remote_validate (`bool`, *optional*, defaults to `False`):
+            If `True`, validate remote model access and file exists before downloading
 
     Returns:
         Local path (string) of file
     """
     if not model_id:
         raise ValueError('model_id shoud not be empty')
 
@@ -83,49 +86,69 @@
     if not local_dir.exists():
         raise ValueError(f"local directory '{local_dir}' not exists")
 
     local_file_path = local_dir / file_path
     if local_file_path.exists() and not force_download:
         raise ValueError(f"'{file_path}' already exists at local, set 'force_download=True' to overwrite")
 
+    if remote_validate:
+        flag = False
+        model_files = model_file_list(model_id, is_public=is_public, revision=revision)
+        for mf in model_files:
+            if mf['path'] == file_path:
+                if mf['file_type'] == 'FileType_Dir':
+                    raise ValueError(f"'{file_path}' is a remote direcotry, not a file path")
+                flag = True
+                break
+        if not flag:
+            raise ValueError(f"remote file '{file_path}' not exists, or you have no access permission")
+
     local_file_path.parent.mkdir(parents=True, exist_ok=True)
     # Prevent parallel downloads of the same file with a lock.
     lock_path = Path(str(local_file_path) + ".lock")
-    with FileLock(lock_path):
-        if resume_download:
-            incomplete_path = Path(str(local_file_path) + ".incomplete")
-
-            @contextmanager
-            def _resumable_file_manager() -> Generator[io.BufferedWriter, None, None]:
-                with open(incomplete_path, "ab") as f:
-                    yield f
-
-            temp_file_manager = _resumable_file_manager
-        else:
-            temp_file_manager = partial(  # type: ignore
-                tempfile.NamedTemporaryFile, mode="wb", dir=local_dir, delete=False
-            )
-
-        # Download to temporary file, then copy to local dir once finished.
-        # Otherwise you get corrupt entries if the download gets interrupted.
-        with temp_file_manager() as temp_file:
-            _http_get_model_file(
-                temp_file,
-                model_id,
-                file_path,
-                is_public = is_public,
-                revision = revision,
-            )
-
-        os.replace(temp_file.name, local_file_path)
-
+    temp_file_name = None
     try:
-        lock_path.unlink()
-    except OSError:
-        pass
+        with FileLock(lock_path):
+            if resume_download:
+                incomplete_path = Path(str(local_file_path) + ".incomplete")
+
+                @contextmanager
+                def _resumable_file_manager() -> Generator[io.BufferedWriter, None, None]:
+                    with open(incomplete_path, "ab") as f:
+                        yield f
+
+                temp_file_manager = _resumable_file_manager
+            else:
+                temp_file_manager = partial(  # type: ignore
+                    tempfile.NamedTemporaryFile, mode="wb", dir=local_dir, delete=False
+                )
+
+            # Download to temporary file, then copy to local dir once finished.
+            # Otherwise you get corrupt entries if the download gets interrupted.
+            with temp_file_manager() as temp_file:
+                temp_file_name = temp_file.name
+                _http_get_model_file(
+                    temp_file,
+                    model_id,
+                    file_path,
+                    is_public = is_public,
+                    revision = revision,
+                )
+
+            os.replace(temp_file.name, local_file_path)
+    finally: # gc
+        # clear lock file
+        try:
+            lock_path.unlink()
+        except OSError:
+            pass
+
+        # clear temp file
+        if not resume_download and os.path.exists(temp_file_name):
+            os.remove(temp_file_name)
 
     return str(local_file_path)
 
 API_FILE_DOWNLOAD_RETRY_TIMES = 3
 API_FILE_DOWNLOAD_TIMEOUT = 60 * 5
 API_FILE_DOWNLOAD_CHUNK_SIZE = 1024 * 1024
 
@@ -206,15 +229,15 @@
     An alternative would be to clone the repo but this requires git and git-lfs to be installed and properly
     configured. It is also not possible to filter which files to download when cloning a repository using git.
 
     Args:
         model_id (`str`):
             model_id
         local_dir (`str` or `Path`, *optional*:
-            the downloaded files will be placed under this directory 
+            the downloaded files will be placed under this directory
         is_public (`bool`, *optional*):
             whether public model, default to user model
         revision (`str`, *optional*):
             An optional Git revision id which can be a branch name, a tag, or a
             commit hash.
         force_download (`bool`, *optional*, defaults to `False`):
             Whether the file should be downloaded even if it already exists in the local dir.
@@ -243,15 +266,15 @@
         raise ValueError('model_id shoud not be empty')
 
     if not local_dir:
         raise ValueError('local_dir shoud not be specified')
     local_dir_path = Path(local_dir).expanduser()
     if not local_dir_path.exists():
         raise ValueError(f"local directory '{local_dir}' not exists")
-    
+
     if not ignore_patterns:
         ignore_patterns = []
     elif isinstance(ignore_patterns, str):
         ignore_patterns = [ignore_patterns]
 
     model_files = model_file_list(model_id, is_public=is_public, revision=revision)
 
@@ -272,10 +295,10 @@
             model_id,
             file_path,
             is_public=is_public,
             revision=revision,
             local_dir=local_dir,
             force_download=force_download,
             resume_download=resume_download,
+            remote_validate=False,
         )
-    return local_dir
-
+    return local_dir
```

## Comparing `scoamppro-0.3.2.dist-info/LICENSE` & `scoamppro-0.3.3.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `scoamppro-0.3.2.dist-info/METADATA` & `scoamppro-0.3.3.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: scoamppro
-Version: 0.3.2
+Version: 0.3.3
 Summary: SenseCore AI Model Platform Command Line Tool
 Home-page: UNKNOWN
 Author: SenseTime, Inc.
 Author-email: hpan@sensetime.com
 License: Apache 2.0
 Keywords: machine-learning deep-learning models
 Platform: UNKNOWN
```

## Comparing `scoamppro-0.3.2.dist-info/RECORD` & `scoamppro-0.3.3.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,23 +1,23 @@
-scoamp/__init__.py,sha256=bqu4G7Is-8Were-hMi-SthEalL7QW-PAbKWGZ9pVB6U,22
+scoamp/__init__.py,sha256=on4Bj4mGEjEjyUkQExxprhOoEopcv_sPapsEnNxyelE,22
 scoamp/api.py,sha256=RmmZNMrVXJ7W3XFZBcfyBVyWJ1VjiyN2u_KyMTD4BEc,6668
-scoamp/toolkit.py,sha256=76ptHxR3yh2kQxjzP0Ei4ajXUZslD2eMkPLD1N3Qgdo,9566
+scoamp/toolkit.py,sha256=H5uwZZDSt-yJnXDQE_IjaOFQuYQmYxUGUEU4g6Meozo,10676
 scoamp/commands/__init__.py,sha256=y1F-rP1F_zPOEYhMd_wRmC9a6ZZyr9QcE4GWkIbT0og,486
 scoamp/commands/api.py,sha256=XKF41Aen-tsEe5lH4CPacH8lIBPtBv4WTQXpMabVQaI,4668
 scoamp/commands/lfs.py,sha256=YA4Zj7W7lzoYQF-ulcG1bRgnJ0TXyi_D0JE4aLNNJzU,7581
 scoamp/commands/internal/__init__.py,sha256=BhbnTTLaPYmwsSbqmeO7HJGRI0shfR9w5xarrh98png,117
 scoamp/commands/internal/env.py,sha256=69NgRrreuJvpy3pT4NLrBbL6tdxW9xNDsT8jQ_VroNY,1374
 scoamp/commands/internal/public_model.py,sha256=_5RSpBcuk442hRxfqjBQEDSKagtpNd55hMQHjQRdims,11723
 scoamp/schema/public-model-meta.json,sha256=EIQMSVftVNCt6GS6-x9XbKirK-SS75mJRKMsFQWCsEg,2135
 scoamp/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 scoamp/utils/api_utils.py,sha256=P9JHJl2KHOqspJrHMOsLvJl-FY3CpjBWDjglNncGQHU,5080
 scoamp/utils/error.py,sha256=g9LWBJd89hSzq2adqHfhBq0TIUz-K2pv-XyU8wg_zoM,1692
 scoamp/utils/helper.py,sha256=KLH089HaSyENxYb0c0o9b1aUJgvnGWL6GYInAfEdEF0,5150
 scoamp/utils/logger.py,sha256=PQcpywlU1IHbv1dvdKOI2s3hNqR3KlRIRurqFKfeDag,405
 tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 tests/test_utils_helper.py,sha256=gFx9h7jjiCao2hbZoT_ES08xtrFRizfPLIvp17uronQ,9110
-scoamppro-0.3.2.dist-info/LICENSE,sha256=R-z_qud7owqMORJyRv9VAVEhRkcRWJOyCJnyCG4Ds5E,11334
-scoamppro-0.3.2.dist-info/METADATA,sha256=oOEmzypv_H4q3Sr1a5GgG8b_wPOG_1fa300xhxtrCHk,1237
-scoamppro-0.3.2.dist-info/WHEEL,sha256=EVRjI69F5qVjm_YgqcTXPnTAv3BfSUr0WVAHuSP3Xoo,92
-scoamppro-0.3.2.dist-info/entry_points.txt,sha256=oXMR4tQerRPB0zht7ok37JQCiiq-XL0B1hFDgAkI90M,48
-scoamppro-0.3.2.dist-info/top_level.txt,sha256=R-1KO00uSz-w1PWLRS6mRHjNP5yFJIKSrafHwVzvYBU,13
-scoamppro-0.3.2.dist-info/RECORD,,
+scoamppro-0.3.3.dist-info/LICENSE,sha256=R-z_qud7owqMORJyRv9VAVEhRkcRWJOyCJnyCG4Ds5E,11334
+scoamppro-0.3.3.dist-info/METADATA,sha256=pls-00xrhYWIeLuflWc-EqDfi7I4xZaScGlTpQrQS7Y,1237
+scoamppro-0.3.3.dist-info/WHEEL,sha256=EVRjI69F5qVjm_YgqcTXPnTAv3BfSUr0WVAHuSP3Xoo,92
+scoamppro-0.3.3.dist-info/entry_points.txt,sha256=oXMR4tQerRPB0zht7ok37JQCiiq-XL0B1hFDgAkI90M,48
+scoamppro-0.3.3.dist-info/top_level.txt,sha256=R-1KO00uSz-w1PWLRS6mRHjNP5yFJIKSrafHwVzvYBU,13
+scoamppro-0.3.3.dist-info/RECORD,,
```

